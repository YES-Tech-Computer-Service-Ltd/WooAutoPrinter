# Android Crash Reporter ä½¿ç”¨æŒ‡å—

è¿™æ˜¯ä¸€ä¸ªå®Œæ•´çš„Androidå´©æºƒæŠ¥å‘Šç³»ç»Ÿï¼Œä¸WordPressåç«¯æ’ä»¶é…åˆä½¿ç”¨ï¼Œæä¾›å…¨é¢çš„å´©æºƒç›‘æ§å’ŒæŠ¥å‘ŠåŠŸèƒ½ã€‚

## åŠŸèƒ½ç‰¹ç‚¹

- ğŸ”„ **è‡ªåŠ¨å´©æºƒæ•è·**ï¼šæ•è·æœªå¤„ç†çš„å¼‚å¸¸å’Œåº”ç”¨å´©æºƒ
- ğŸ“Š **è¯¦ç»†è®¾å¤‡ä¿¡æ¯**ï¼šæ”¶é›†è®¾å¤‡å‹å·ã€ç³»ç»Ÿç‰ˆæœ¬ã€å†…å­˜çŠ¶æ€ç­‰
- ğŸ“¤ **æ™ºèƒ½ä¸Šä¼ **ï¼šå¤±è´¥é‡è¯•ã€ç¦»çº¿ç¼“å­˜ã€ç½‘ç»œçŠ¶æ€æ£€æµ‹
- ğŸ¯ **ä¸¥é‡ç¨‹åº¦åˆ†çº§**ï¼šè‡ªåŠ¨åˆ¤æ–­é”™è¯¯ä¸¥é‡ç¨‹åº¦
- ğŸ”§ **è‡ªå®šä¹‰æ•°æ®**ï¼šæ”¯æŒæ·»åŠ ä¸šåŠ¡ç›¸å…³çš„è‡ªå®šä¹‰ä¿¡æ¯
- ğŸ›¡ï¸ **å®‰å…¨å¯é **ï¼šAPIå¯†é’¥è®¤è¯ã€æ•°æ®åŠ å¯†ä¼ è¾“

## å¿«é€Ÿå¼€å§‹

### 1. é…ç½®WordPressåç«¯

é¦–å…ˆç¡®ä¿WordPressç«™ç‚¹å·²å®‰è£…å¹¶é…ç½®äº†crash reporteræ’ä»¶ï¼Œè·å–ï¼š
- APIç«¯ç‚¹URL
- APIå¯†é’¥

### 2. åœ¨Applicationä¸­åˆå§‹åŒ–

```kotlin
class YourApplication : Application() {
    override fun onCreate() {
        super.onCreate()
        
        // åˆå§‹åŒ–å´©æºƒæŠ¥å‘Šç³»ç»Ÿï¼ˆåº”è¯¥åœ¨æ‰€æœ‰å…¶ä»–åˆå§‹åŒ–ä¹‹å‰ï¼‰
        CrashReporterManager.initialize(
            context = this,
            apiEndpoint = "https://yoursite.com/wp-json/android-crash/v2/report",
            apiKey = "your_api_key_here",
            enableDebugLogs = BuildConfig.DEBUG
        )
    }
}
```

### 3. æŠ¥å‘Šéè‡´å‘½å¼‚å¸¸

```kotlin
try {
    // å¯èƒ½å‡ºé”™çš„ä»£ç 
    riskyOperation()
} catch (e: Exception) {
    // æŠ¥å‘Šå¼‚å¸¸å¹¶ç»§ç»­æ‰§è¡Œ
    CrashReporterManager.reportException(e, mapOf(
        "operation" to "data_sync",
        "user_id" to "12345"
    ))
}
```

## è¯¦ç»†ä½¿ç”¨æ–¹æ³•

### æŠ¥å‘Šç½‘ç»œé”™è¯¯

```kotlin
CrashReporterUtils.reportNetworkError(
    url = "https://api.example.com/data",
    method = "GET",
    responseCode = 500,
    errorMessage = "æœåŠ¡å™¨å†…éƒ¨é”™è¯¯"
)
```

### æŠ¥å‘Šæ•°æ®åº“é”™è¯¯

```kotlin
CrashReporterUtils.reportDatabaseError(
    query = "SELECT * FROM users WHERE id = ?",
    errorMessage = "æ•°æ®åº“è¿æ¥å¤±è´¥"
)
```

### æŠ¥å‘Šç”¨æˆ·æ“ä½œé”™è¯¯

```kotlin
CrashReporterUtils.reportUserActionError(
    action = "submit_order",
    screen = "CheckoutActivity",
    errorMessage = "è®¢å•æäº¤å¤±è´¥"
)
)
```

### æŠ¥å‘Šæ€§èƒ½é—®é¢˜

```kotlin
val startTime = System.currentTimeMillis()
performLongOperation()
val duration = System.currentTimeMillis() - startTime

CrashReporterUtils.reportPerformanceIssue(
    operation = "image_processing",
    duration = duration,
    threshold = 5000 // 5ç§’é˜ˆå€¼
)
```

### ä½¿ç”¨å·¥å…·å‡½æ•°æ•è·å¼‚å¸¸

```kotlin
val result = CrashReporterUtils.catchAndReport(
    errorType = "DataProcessing",
    customData = mapOf("batch_size" to "100")
) {
    // å¯èƒ½å‡ºé”™çš„ä»£ç 
    processDataBatch()
}
```

## é”™è¯¯ç±»å‹åˆ†ç±»

ç³»ç»Ÿä¼šè‡ªåŠ¨æ ¹æ®å¼‚å¸¸ç±»å‹åˆ¤æ–­ä¸¥é‡ç¨‹åº¦ï¼š

### Criticalï¼ˆä¸¥é‡ï¼‰
- `OutOfMemoryError`
- `SecurityException`
- åº”ç”¨å´©æºƒï¼ˆfatal errorsï¼‰

### Highï¼ˆé«˜ï¼‰
- `NullPointerException`
- `RuntimeException`
- `IllegalStateException`
- `ClassCastException`

### Mediumï¼ˆä¸­ç­‰ï¼‰
- `IOException`
- `SQLException`
- `ParseException`

### Lowï¼ˆä½ï¼‰
- å…¶ä»–å¼‚å¸¸ç±»å‹

## æœ€ä½³å®è·µ

### 1. æ—©æœŸåˆå§‹åŒ–
åœ¨Application.onCreate()çš„æœ€å¼€å§‹åˆå§‹åŒ–å´©æºƒæŠ¥å‘Šç³»ç»Ÿï¼š

```kotlin
override fun onCreate() {
    super.onCreate()
    
    // ç¬¬ä¸€æ­¥ï¼šåˆå§‹åŒ–å´©æºƒæŠ¥å‘Š
    initializeCrashReporter()
    
    // ç„¶åè¿›è¡Œå…¶ä»–åˆå§‹åŒ–
    initializeOtherComponents()
}
```

### 2. æ·»åŠ ä¸Šä¸‹æ–‡ä¿¡æ¯
æŠ¥å‘Šå¼‚å¸¸æ—¶æä¾›æœ‰ç”¨çš„ä¸Šä¸‹æ–‡ä¿¡æ¯ï¼š

```kotlin
CrashReporterManager.reportException(exception, mapOf(
    "user_id" to getCurrentUserId(),
    "screen" to getCurrentScreen(),
    "action" to "button_click",
    "app_state" to getAppState()
))
```

### 3. ç½‘ç»œçŠ¶æ€è€ƒè™‘
ç³»ç»Ÿä¼šè‡ªåŠ¨å¤„ç†ç½‘ç»œçŠ¶æ€ï¼Œä½†ä½ å¯ä»¥æ‰‹åŠ¨æ§åˆ¶ï¼š

```kotlin
// åœ¨ç½‘ç»œæ¢å¤æ—¶ä¸Šä¼ å¾…å¤„ç†çš„å´©æºƒæŠ¥å‘Š
if (NetworkChecker.isNetworkAvailable(context)) {
    CrashReporterManager.uploadPendingCrashes()
}
```

### 4. å®šæœŸæ¸…ç†
å®šæœŸæ¸…ç†æ—§çš„å´©æºƒæ–‡ä»¶ï¼š

```kotlin
// åœ¨é€‚å½“çš„æ—¶æœºï¼ˆå¦‚åº”ç”¨å¯åŠ¨æ—¶ï¼‰æ¸…ç†
CrashReporterManager.cleanupOldCrashes()
```

## å¸¸è§é”™è¯¯ç åŠè§¦å‘æ¡ä»¶

### HTTPçŠ¶æ€ç 

| çŠ¶æ€ç  | å«ä¹‰ | è§¦å‘æ¡ä»¶ | å¤„ç†æ–¹å¼ |
|--------|------|----------|----------|
| 200/201 | æˆåŠŸ | æŠ¥å‘Šæ­£å¸¸ä¸Šä¼  | åˆ é™¤æœ¬åœ°æ–‡ä»¶ |
| 400 | è¯·æ±‚é”™è¯¯ | ç¼ºå°‘å¿…éœ€å‚æ•°ã€JSONæ ¼å¼é”™è¯¯ | ä¸é‡è¯•ï¼Œè®°å½•é”™è¯¯ |
| 401 | è®¤è¯å¤±è´¥ | APIå¯†é’¥æ— æ•ˆæˆ–è¿‡æœŸ | ä¸é‡è¯•ï¼Œæ£€æŸ¥é…ç½® |
| 413 | æ–‡ä»¶è¿‡å¤§ | ä¸Šä¼ æ–‡ä»¶è¶…è¿‡10MBé™åˆ¶ | ä¸é‡è¯•ï¼Œå‹ç¼©æ•°æ® |
| 429 | é¢‘ç‡é™åˆ¶ | è¶…è¿‡æ¯5åˆ†é’Ÿ20æ¬¡è¯·æ±‚é™åˆ¶ | ç­‰å¾…åé‡è¯• |
| 500-504 | æœåŠ¡å™¨é”™è¯¯ | WordPressæœåŠ¡å™¨é—®é¢˜ | é‡è¯•ä¸Šä¼  |
| 507 | å­˜å‚¨ç©ºé—´ä¸è¶³ | æœåŠ¡å™¨å­˜å‚¨è¾¾åˆ°ä¸Šé™ | ç­‰å¾…åé‡è¯• |

### åº”ç”¨å†…é”™è¯¯ç 

| é”™è¯¯ç±»å‹ | è§¦å‘æ¡ä»¶ | ä¸¥é‡ç¨‹åº¦ |
|----------|----------|----------|
| `NetworkError` | ç½‘ç»œè¯·æ±‚å¤±è´¥ | Medium |
| `DatabaseError` | æ•°æ®åº“æ“ä½œå¤±è´¥ | High |
| `OutOfMemoryError` | å†…å­˜ä¸è¶³ | Critical |
| `NullPointerException` | ç©ºæŒ‡é’ˆå¼‚å¸¸ | High |
| `SecurityException` | æƒé™æˆ–å®‰å…¨é—®é¢˜ | Critical |
| `ValidationError` | æ•°æ®éªŒè¯å¤±è´¥ | Low |
| `PerformanceIssue` | æ“ä½œè€—æ—¶è¿‡é•¿ | Medium |

## æ•…éšœæ’é™¤

### 1. æŠ¥å‘Šä¸Šä¼ å¤±è´¥
æ£€æŸ¥ï¼š
- APIç«¯ç‚¹URLæ˜¯å¦æ­£ç¡®
- APIå¯†é’¥æ˜¯å¦æœ‰æ•ˆ
- ç½‘ç»œè¿æ¥æ˜¯å¦æ­£å¸¸
- WordPressæ’ä»¶æ˜¯å¦æ­£å¸¸å·¥ä½œ

### 2. å¼‚å¸¸æœªè¢«æ•è·
ç¡®ä¿ï¼š
- åœ¨Application.onCreate()ä¸­æ­£ç¡®åˆå§‹åŒ–
- å¼‚å¸¸å‘ç”Ÿåœ¨åˆå§‹åŒ–ä¹‹å
- æ²¡æœ‰å…¶ä»–å¼‚å¸¸å¤„ç†å™¨å¹²æ‰°

### 3. æ€§èƒ½å½±å“
- å´©æºƒæŠ¥å‘Šåœ¨åå°çº¿ç¨‹å¤„ç†ï¼Œä¸å½±å“UI
- æœ¬åœ°æ–‡ä»¶è‡ªåŠ¨æ¸…ç†ï¼Œé¿å…å­˜å‚¨å ç”¨
- ç½‘ç»œä¸Šä¼ ä½¿ç”¨é‡è¯•æœºåˆ¶ï¼Œé¿å…é˜»å¡

## é…ç½®é€‰é¡¹

```kotlin
val config = CrashReporterConfig(
    apiEndpoint = "APIç«¯ç‚¹",
    apiKey = "APIå¯†é’¥",
    enableAutoUpload = true,           // è‡ªåŠ¨ä¸Šä¼ 
    enableDebugLogs = BuildConfig.DEBUG, // è°ƒè¯•æ—¥å¿—
    maxRetries = 3,                    // æœ€å¤§é‡è¯•æ¬¡æ•°
    connectTimeoutMs = 30000,          // è¿æ¥è¶…æ—¶
    readTimeoutMs = 30000              // è¯»å–è¶…æ—¶
)
```

## æ³¨æ„äº‹é¡¹

1. **éšç§ä¿æŠ¤**ï¼šä¸è¦åœ¨å´©æºƒæŠ¥å‘Šä¸­åŒ…å«æ•æ„Ÿä¿¡æ¯ï¼ˆå¯†ç ã€ä»¤ç‰Œç­‰ï¼‰
2. **APIå¯†é’¥å®‰å…¨**ï¼šå°†APIå¯†é’¥å­˜å‚¨åœ¨å®‰å…¨ä½ç½®ï¼Œä¸è¦ç¡¬ç¼–ç 
3. **æ–‡ä»¶æ¸…ç†**ï¼šå®šæœŸæ¸…ç†æ—§çš„å´©æºƒæ–‡ä»¶ï¼Œé¿å…å ç”¨è¿‡å¤šå­˜å‚¨ç©ºé—´
4. **ç½‘ç»œæµé‡**ï¼šåœ¨ç§»åŠ¨ç½‘ç»œä¸‹è€ƒè™‘é™åˆ¶ä¸Šä¼ é¢‘ç‡
5. **ç”¨æˆ·åŒæ„**ï¼šæ ¹æ®æ³•å¾‹è¦æ±‚ï¼Œå¯èƒ½éœ€è¦ç”¨æˆ·åŒæ„æ”¶é›†å´©æºƒæ•°æ® 